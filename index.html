<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SoloBet Admin Paneli</title>
    <meta name="robots" content="noindex, nofollow">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }
        
        .login-card {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            text-align: center;
            max-width: 400px;
            width: 100%;
        }
        
        .logo-admin {
            font-size: 3rem;
            margin-bottom: 20px;
        }
        
        .login-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 30px;
            color: #333;
        }
        
        .input-group {
            margin: 20px 0;
            text-align: left;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }
        
        .input-group input, .input-group textarea, .input-group select {
            width: 100%;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 1rem;
            transition: border-color 0.3s;
            box-sizing: border-box;
        }
        
        .input-group input:focus, .input-group textarea:focus, .input-group select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }
        
        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }
        
        .btn-sm {
            padding: 8px 15px;
            font-size: 0.8rem;
        }
        
        .btn-active {
            background: #28a745;
        }
        
        .btn-next {
            background: #ffc107;
            color: #333;
        }
        
        .btn-inactive {
            background: #dc3545;
        }
        
        .btn-danger {
            background: #dc3545;
        }
        
        .btn-success {
            background: #28a745;
        }
        
        .btn-secondary {
            background: #6c757d;
        }
        
        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            display: none;
        }
        
        .dashboard {
            display: none;
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .dashboard-header {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .dashboard-title {
            font-size: 2rem;
            font-weight: 700;
            color: #333;
        }
        
        .logout-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: 900;
            color: #667eea;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9rem;
            font-weight: 600;
        }
        
        .admin-section {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .section-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: #333;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        
        .url-management {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .url-item {
            display: grid;
            grid-template-columns: 1fr auto auto auto auto;
            gap: 10px;
            align-items: center;
            padding: 15px;
            background: white;
            margin-bottom: 10px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }
        
        .url-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
        }
        
        .url-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .url-drag-handle {
            cursor: grab;
            color: #666;
            font-size: 1.2rem;
        }
        
        .url-drag-handle:active {
            cursor: grabbing;
        }
        
        .url-name {
            font-weight: 700;
            font-size: 1.1rem;
            color: #333;
        }
        
        .url-order {
            background: #e9ecef;
            color: #666;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .current-status {
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 700;
            text-transform: uppercase;
            border: 2px solid;
        }
        
        .status-active {
            background: #d4edda;
            color: #155724;
            border-color: #28a745;
        }
        
        .status-next {
            background: #fff3cd;
            color: #856404;
            border-color: #ffc107;
        }
        
        .status-inactive {
            background: #f8d7da;
            color: #721c24;
            border-color: #dc3545;
        }
        
        .action-buttons {
            display: flex;
            gap: 5px;
        }
        
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .quick-action-btn {
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            color: white;
            border: none;
            font-size: 0.9rem;
        }
        
        .quick-action-btn:hover {
            transform: translateY(-2px);
        }
        
        .action-primary {
            background: #667eea;
        }
        
        .action-warning {
            background: #ffc107;
            color: #333;
        }
        
        .action-danger {
            background: #dc3545;
        }
        
        .action-success {
            background: #28a745;
        }
        
        .realtime-log {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            height: 250px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            margin: 20px 0;
        }
        
        .log-entry {
            margin: 3px 0;
            padding: 6px;
            border-radius: 4px;
            border-left: 3px solid;
        }
        
        .log-info {
            background: #d1ecf1;
            color: #0c5460;
            border-left-color: #17a2b8;
        }
        
        .log-success {
            background: #d4edda;
            color: #155724;
            border-left-color: #28a745;
        }
        
        .log-error {
            background: #f8d7da;
            color: #721c24;
            border-left-color: #dc3545;
        }
        
        .log-warning {
            background: #fff3cd;
            color: #856404;
            border-left-color: #ffc107;
        }
        
        .notification-preview {
            background: #e7f1ff;
            border: 1px solid #b8daff;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .preview-title {
            font-weight: 700;
            font-size: 1rem;
            margin-bottom: 8px;
        }
        
        .preview-message {
            color: #666;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        .empty-state-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            opacity: 0.5;
        }
        
        @media (max-width: 768px) {
            .dashboard {
                padding: 15px;
            }
            
            .dashboard-header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .url-item {
                grid-template-columns: 1fr;
                text-align: center;
                gap: 15px;
            }
            
            .url-info {
                justify-content: center;
            }
            
            .action-buttons {
                justify-content: center;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-container">
        <div class="login-card">
            <div class="logo-admin">üõ°Ô∏è</div>
            <h1 class="login-title">Admin Paneli</h1>
            <div class="error-message" id="errorMessage">Ge√ßersiz kullanƒ±cƒ± adƒ± veya ≈üifre!</div>
            
            <div class="input-group">
                <label>Kullanƒ±cƒ± Adƒ±</label>
                <input type="text" id="username" placeholder="Admin kullanƒ±cƒ± adƒ±" />
            </div>
            
            <div class="input-group">
                <label>≈ûifre</label>
                <input type="password" id="password" placeholder="Admin ≈üifresi" />
            </div>
            
            <button class="btn" onclick="login()">Giri≈ü Yap</button>
        </div>
    </div>

    <!-- Dashboard -->
    <div id="dashboard" class="dashboard">
        <div class="dashboard-header">
            <h1 class="dashboard-title">üéõÔ∏è SoloBet Admin Paneli</h1>
            <button class="logout-btn" onclick="logout()">√áƒ±kƒ±≈ü Yap</button>
        </div>

        <!-- Statistics -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="totalUrls">0</div>
                <div class="stat-label">Toplam URL</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="activeUrls">0</div>
                <div class="stat-label">Aktif URL</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalUsers">0</div>
                <div class="stat-label">Toplam Kullanƒ±cƒ±</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="todayVisits">0</div>
                <div class="stat-label">Bug√ºnk√º Ziyaret</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="notificationsSent">0</div>
                <div class="stat-label">G√∂nderilen Bildirim</div>
            </div>
        </div>

        <!-- URL Management -->
        <div class="admin-section">
            <h2 class="section-title">üåê URL Durum Y√∂netimi</h2>
            
            <!-- Quick Actions -->
            <div class="quick-actions">
                <button class="quick-action-btn action-success" onclick="addNewUrl()">
                    ‚ûï Yeni URL Ekle
                </button>
                <button class="quick-action-btn action-primary" onclick="checkAllUrls()">
                    üîÑ T√ºm URL'leri Kontrol Et
                </button>
                <button class="quick-action-btn action-warning" onclick="reorderUrls()">
                    üìã Sƒ±ralamayƒ± D√ºzenle
                </button>
                <button class="quick-action-btn action-danger" onclick="resetAllStatus()">
                    üîÑ Durumlarƒ± Sƒ±fƒ±rla
                </button>
            </div>
            
            <div class="input-group">
                <label>Yeni URL Ekle</label>
                <div style="display: flex; gap: 10px;">
                    <input type="text" id="newUrl" placeholder="√∂rnek: solobet5.com" style="flex: 1;" />
                    <button class="btn btn-success" onclick="addUrl()">Ekle</button>
                </div>
            </div>

            <div class="url-management" id="urlManagement">
                <div class="empty-state">
                    <div class="empty-state-icon">üåê</div>
                    <p>URL'ler y√ºkleniyor...</p>
                </div>
            </div>
        </div>

        <!-- Notification Management -->
        <div class="admin-section">
            <h2 class="section-title">üîî Bildirim Y√∂netimi</h2>
            <div class="input-group">
                <label>Bildirim Ba≈ülƒ±ƒüƒ±</label>
                <input type="text" id="notificationTitle" placeholder="SoloBet G√ºncelleme" value="SoloBet G√ºncelleme" />
            </div>
            <div class="input-group">
                <label>Bildirim Mesajƒ±</label>
                <textarea id="notificationMessage" placeholder="Yeni g√ºncellemeler mevcut..." rows="3">Yeni g√ºncellemeler mevcut...</textarea>
            </div>
            <button class="btn btn-success" onclick="sendBulkNotification()">T√ºm Kullanƒ±cƒ±lara G√∂nder</button>

            <div class="notification-preview">
                <strong>üì± Bildirim √ñnizlemesi:</strong>
                <div class="preview-title" id="previewTitle">SoloBet G√ºncelleme</div>
                <div class="preview-message" id="previewMessage">Yeni g√ºncellemeler mevcut...</div>
            </div>
        </div>

        <!-- Real-time Logs -->
        <div class="admin-section">
            <h2 class="section-title">üìä Canlƒ± Sistem Loglarƒ±</h2>
            <div class="realtime-log" id="realtimeLog">
                <div class="log-entry log-info">
                    <strong>[INFO]</strong> Admin paneli ba≈ülatƒ±ldƒ± - <span id="startTime"></span>
                </div>
            </div>
            <button class="btn btn-secondary" onclick="clearLogs()">Loglarƒ± Temizle</button>
        </div>
    </div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBGCbLgFY5u7TUs7njM2PAqUyRTCQuIx6E",
            authDomain: "guncelsolobet.firebaseapp.com",
            databaseURL: "https://guncelsolobet-default-rtdb.europe-west1.firebasedatabase.app/",
            projectId: "guncelsolobet",
            storageBucket: "guncelsolobet.firebasestorage.app",
            messagingSenderId: "282558930683",
            appId: "1:282558930683:web:80751459579a9c31d15a5e",
            measurementId: "G-2N007WSPVB"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // Admin credentials
        const ADMIN_CREDENTIALS = {
            username: 'solobet-admin',
            password: 'SoloBet2025!@#'
        };

        let isLoggedIn = false;
        let urlsData = [];
        let stats = {
            totalUrls: 0,
            activeUrls: 0,
            totalUsers: 0,
            todayVisits: 0,
            notificationsSent: 0
        };

        // Authentication
        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const errorMsg = document.getElementById('errorMessage');

            if (username === ADMIN_CREDENTIALS.username && password === ADMIN_CREDENTIALS.password) {
                isLoggedIn = true;
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('dashboard').style.display = 'block';
                loadDashboardData();
                addLog('Admin ba≈üarƒ±yla giri≈ü yaptƒ±', 'success');
                sessionStorage.setItem('adminLoggedIn', 'true');
            } else {
                errorMsg.style.display = 'block';
                addLog('Ba≈üarƒ±sƒ±z admin giri≈üi denemesi', 'error');
                setTimeout(() => {
                    errorMsg.style.display = 'none';
                }, 3000);
            }
        }

        function logout() {
            isLoggedIn = false;
            document.getElementById('loginScreen').style.display = 'flex';
            document.getElementById('dashboard').style.display = 'none';
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
            sessionStorage.removeItem('adminLoggedIn');
            addLog('Admin √ßƒ±kƒ±≈ü yaptƒ±', 'info');
        }

        // URL Management with Status
        function addUrl() {
            const newUrlInput = document.getElementById('newUrl');
            const newUrl = newUrlInput.value.trim();
            
            if (!newUrl) {
                alert('L√ºtfen bir URL girin!');
                return;
            }
            
            if (urlsData.find(item => item.url === newUrl)) {
                alert('Bu URL zaten listede mevcut!');
                return;
            }
            
            const newUrlData = {
                url: newUrl,
                status: 'inactive',
                order: urlsData.length + 1,
                addedAt: Date.now()
            };
            
            urlsData.push(newUrlData);
            newUrlInput.value = '';
            updateUrlDisplay();
            saveUrlsToFirebase();
            addLog(`Yeni URL eklendi: ${newUrl}`, 'success');
            updateStats();
        }

        function addNewUrl() {
            const url = prompt('Yeni URL girin (√∂rn: solobet5.com):');
            if (url) {
                document.getElementById('newUrl').value = url;
                addUrl();
            }
        }

        function updateUrlStatus(index, newStatus) {
            // Eƒüer aktif yapƒ±lƒ±yorsa, diƒüerlerini pasif yap
            if (newStatus === 'active') {
                urlsData.forEach(item => {
                    if (item.status === 'active') {
                        item.status = 'inactive';
                    }
                });
            }
            
            // Eƒüer sƒ±radaki yapƒ±lƒ±yorsa, diƒüer sƒ±radakileri pasif yap
            if (newStatus === 'next') {
                urlsData.forEach(item => {
                    if (item.status === 'next') {
                        item.status = 'inactive';
                    }
                });
            }
            
            urlsData[index].status = newStatus;
            updateUrlDisplay();
            saveUrlsToFirebase();
            addLog(`${urlsData[index].url} durumu deƒüi≈ütirildi: ${newStatus}`, 'info');
            updateStats();
        }

        function removeUrl(index) {
            const url = urlsData[index].url;
            if (confirm(`${url} adresini silmek istediƒüinizden emin misiniz?`)) {
                urlsData.splice(index, 1);
                updateUrlDisplay();
                saveUrlsToFirebase();
                addLog(`URL silindi: ${url}`, 'warning');
                updateStats();
            }
        }

        function updateUrlDisplay() {
            const container = document.getElementById('urlManagement');
            
            if (urlsData.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üåê</div>
                        <p>Hen√ºz URL eklenmemi≈ü</p>
                        <button class="btn btn-success" onclick="addNewUrl()">ƒ∞lk URL'yi Ekle</button>
                    </div>
                `;
                return;
            }
            
            // Sort by order
            urlsData.sort((a, b) => a.order - b.order);
            
            container.innerHTML = urlsData.map((item, index) => `
                <div class="url-item">
                    <div class="url-info">
                        <div class="url-drag-handle">‚ãÆ‚ãÆ</div>
                        <div class="url-order">#${item.order}</div>
                        <div class="url-name">${item.url}</div>
                    </div>
                    <div class="current-status status-${item.status}">
                        ${item.status === 'active' ? 'Aktif' : item.status === 'next' ? 'Sƒ±radaki' : 'Pasif'}
                    </div>
                    <button class="btn btn-sm btn-active" onclick="updateUrlStatus(${index}, 'active')" title="Aktif Yap">
                        üü¢
                    </button>
                    <button class="btn btn-sm btn-next" onclick="updateUrlStatus(${index}, 'next')" title="Sƒ±radaki Yap">
                        üü°
                    </button>
                    <button class="btn btn-sm btn-inactive" onclick="updateUrlStatus(${index}, 'inactive')" title="Pasif Yap">
                        üî¥
                    </button>
                    <button class="btn btn-sm btn-danger" onclick="removeUrl(${index})" title="Sil">
                        üóëÔ∏è
                    </button>
                </div>
            `).join('');
        }

        function checkAllUrls() {
            addLog('T√ºm URL\'ler kontrol ediliyor...', 'info');
            
            urlsData.forEach(async (item, index) => {
                // Simulated URL check
                const isActive = Math.random() > 0.3;
                const statusText = isActive ? '√ßalƒ±≈üƒ±yor' : '√ßalƒ±≈ümƒ±yor';
                addLog(`${item.url} - ${statusText}`, isActive ? 'success' : 'error');
            });
            
            setTimeout(() => {
                addLog('URL kontrol i≈ülemi tamamlandƒ±', 'success');
            }, 2000);
        }

        function reorderUrls() {
            addLog('Sƒ±ralama d√ºzenleme modu a√ßƒ±ldƒ±', 'info');
            alert('URL\'leri s√ºr√ºkleyerek yeniden sƒ±ralayabilirsiniz. (Geli≈ütirilecek √∂zellik)');
        }

        function resetAllStatus() {
            if (confirm('T√ºm URL durumlarƒ±nƒ± sƒ±fƒ±rlamak istediƒüinizden emin misiniz?')) {
                urlsData.forEach(item => {
                    item.status = 'inactive';
                });
                updateUrlDisplay();
                saveUrlsToFirebase();
                addLog('T√ºm URL durumlarƒ± sƒ±fƒ±rlandƒ±', 'warning');
                updateStats();
            }
        }

        function saveUrlsToFirebase() {
            database.ref('urlsData').set(urlsData);
            
            // Backward compatibility - save simple URL array
            const simpleUrls = urlsData.map(item => item.url);
            database.ref('urls').set(simpleUrls);
        }

        // Notification Management
        function sendBulkNotification() {
            const title = document.getElementById('notificationTitle').value || 'SoloBet G√ºncelleme';
            const message = document.getElementById('notificationMessage').value || 'Yeni g√ºncellemeler mevcut...';
            
            database.ref('notifications').push({
                title: title,
                message: message,
                timestamp: Date.now(),
                sent: true,
                adminId: 'current-admin'
            });

            stats.notificationsSent++;
            updateStats();
            addLog(`Toplu bildirim g√∂nderildi: "${title}"`, 'success');
            
            database.ref('stats/notificationsSent').set(stats.notificationsSent);
        }

        // Logging System
        function addLog(message, type = 'info') {
            const log = document.getElementById('realtimeLog');
            const timestamp = new Date().toLocaleTimeString('tr-TR');
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry log-${type}`;
            
            let icon = '';
            switch(type) {
                case 'success': icon = '‚úÖ'; break;
                case 'error': icon = '‚ùå'; break;
                case 'warning': icon = '‚ö†Ô∏è'; break;
                default: icon = '‚ÑπÔ∏è';
            }
            
            logEntry.innerHTML = `<strong>[${type.toUpperCase()}]</strong> ${icon} ${message} - ${timestamp}`;
            log.appendChild(logEntry);
            log.scrollTop = log.scrollHeight;

            database.ref('logs').push({
                message: message,
                type: type,
                timestamp: Date.now(),
                adminAction: true
            });
        }

        function clearLogs() {
            if (confirm('T√ºm loglarƒ± temizlemek istediƒüinizden emin misiniz?')) {
                document.getElementById('realtimeLog').innerHTML = '';
                addLog('Loglar temizlendi', 'warning');
            }
        }

        // Statistics
        function updateStats() {
            stats.totalUrls = urlsData.length;
            stats.activeUrls = urlsData.filter(item => item.status === 'active').length;
            
            document.getElementById('totalUrls').textContent = stats.totalUrls;
            document.getElementById('activeUrls').textContent = stats.activeUrls;
            document.getElementById('totalUsers').textContent = stats.totalUsers;
            document.getElementById('todayVisits').textContent = stats.todayVisits;
            document.getElementById('notificationsSent').textContent = stats.notificationsSent;
            
            database.ref('stats').update(stats);
        }

        function loadDashboardData() {
            // Load URLs with status data
            database.ref('urlsData').once('value', (snapshot) => {
                const data = snapshot.val();
                if (data && Array.isArray(data)) {
                    urlsData = data;
                } else if (data) {
                    urlsData = Object.values(data);
                } else {
                    // Initialize with default data
                    urlsData = [
                        { url: 'solobet1.com', status: 'active', order: 1, addedAt: Date.now() },
                        { url: 'solobet2.com', status: 'next', order: 2, addedAt: Date.now() },
                        { url: 'solobet3.com', status: 'inactive', order: 3, addedAt: Date.now() }
                    ];
                    saveUrlsToFirebase();
                }
                updateUrlDisplay();
                updateStats();
            });

            // Load stats
            database.ref('stats').once('value', (snapshot) => {
                const firebaseStats = snapshot.val();
                if (firebaseStats) {
                    stats = { ...stats, ...firebaseStats };
                    updateStats();
                }
            });

            // Real-time listeners
            database.ref('users').on('value', (snapshot) => {
                const users = snapshot.val();
                if (users) {
                    stats.totalUsers = Object.keys(users).length;
                    document.getElementById('totalUsers').textContent = stats.totalUsers;
                }
            });

            database.ref('stats/visits').on('value', (snapshot) => {
                const visits = snapshot.val();
                if (visits) {
                    stats.todayVisits = visits;
                    document.getElementById('todayVisits').textContent = stats.todayVisits;
                }
            });
        }

        // Notification preview updates
        document.getElementById('notificationTitle').addEventListener('input', function() {
            document.getElementById('previewTitle').textContent = this.value || 'SoloBet G√ºncelleme';
        });

        document.getElementById('notificationMessage').addEventListener('input', function() {
            document.getElementById('previewMessage').textContent = this.value || 'Yeni g√ºncellemeler mevcut...';
        });

        // Handle Enter key in login form
        document.addEventListener('keydown', function(e) {
            if (!isLoggedIn && e.key === 'Enter') {
                login();
            }
        });

        // Initialize dashboard
        window.addEventListener('load', () => {
            document.getElementById('startTime').textContent = new Date().toLocaleString('tr-TR');
            
            // Check if already logged in
            const savedSession = sessionStorage.getItem('adminLoggedIn');
            if (savedSession === 'true') {
                isLoggedIn = true;
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('dashboard').style.display = 'block';
                loadDashboardData();
                addLog('Oturum geri y√ºklendi', 'info');
            }
        });
    </script>
</body>
</html>
